{{ define "main" }}
<!-- Hero Section -->
<section class="pt-32 pb-16 md:pt-40 md:pb-24 px-6 bg-lavender section-colored">
    <div class="max-w-4xl mx-auto text-center">
        <a href="{{ .Site.Home.RelPermalink }}" class="inline-flex items-center text-sm font-bold uppercase tracking-widest text-white/80 hover:text-white transition mb-8 font-sans">
            <i class="fa-solid fa-arrow-left mr-2"></i>
            {{ i18n "schedule_back_home" }}
        </a>
        <h1 class="font-hand text-6xl md:text-8xl text-white mb-6">{{ i18n "schedule_title" }}</h1>
        <p class="text-xl text-white/80 font-sans max-w-2xl mx-auto">{{ i18n "schedule_subtitle" }}</p>
    </div>
</section>

<!-- Schedule Section -->
<section class="py-16 md:py-24 px-6 bg-white" x-data="scheduleComponent('{{ .Site.Language.Lang }}')">
    <div class="max-w-3xl mx-auto">
        <!-- Loading State -->
        <div x-show="loading" class="text-center py-12">
            <i class="fa-solid fa-spinner fa-spin text-4xl text-lavender mb-4"></i>
            <p class="text-gray-500 font-sans">{{ i18n "schedule_loading" }}</p>
        </div>

        <!-- Error State -->
        <div x-show="error && !loading" x-cloak class="text-center py-12">
            <div class="w-16 h-16 bg-rose/20 text-rose rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa-solid fa-exclamation-triangle text-2xl"></i>
            </div>
            <p class="text-gray-600 font-sans">{{ i18n "schedule_error" }}</p>
            <button @click="fetchSchedule()" class="mt-4 text-lavender hover:text-lavender/70 font-semibold font-sans">
                {{ i18n "schedule_retry" }}
            </button>
        </div>

        <!-- Empty State -->
        <div x-show="!loading && !error && visibleEvents.length === 0" x-cloak class="text-center py-12">
            <div class="w-16 h-16 bg-lavender/20 text-lavender rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa-solid fa-calendar-xmark text-2xl"></i>
            </div>
            <p class="text-gray-600 font-sans">{{ i18n "schedule_empty" }}</p>
        </div>

        <!-- Schedule Timeline -->
        <div x-show="!loading && !error && visibleEvents.length > 0" x-cloak>
            <!-- Events grouped by day -->
            <template x-for="(dayEvents, date) in groupedEvents" :key="date">
                <div class="mb-12">
                    <!-- Day Header -->
                    <div class="sticky top-20 z-10 bg-white/95 backdrop-blur-sm py-4 mb-6 border-b-2 border-lavender/20">
                        <h2 class="font-hand text-3xl md:text-4xl text-gray-800" x-text="formatDateHeader(date)"></h2>
                    </div>

                    <!-- Events for this day -->
                    <div class="space-y-4">
                        <template x-for="(event, index) in dayEvents" :key="index">
                            <div :class="{ 'opacity-50': event.isPast }">
                                <!-- Mobile: Stacked layout (full-width cards) -->
                                <div class="block md:hidden">
                                    <div class="card-shadow bg-white p-5 rounded-2xl"
                                         :class="{ 'border-l-4 border-lavender': !event.isPast, 'border-l-4 border-gray-300': event.isPast }">
                                        <!-- Time badge at top -->
                                        <div class="flex items-center justify-between mb-3">
                                            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-bold font-sans"
                                                  :class="event.isPast ? 'bg-gray-100 text-gray-500' : 'bg-lavender/10 text-lavender'">
                                                <i class="fa-regular fa-clock mr-2"></i>
                                                <span x-text="event.localStartTime"></span>
                                            </span>
                                            <div x-show="event.isPast" class="inline-flex items-center text-xs font-semibold text-gray-400 font-sans">
                                                <i class="fa-solid fa-check mr-1"></i>
                                                {{ i18n "schedule_completed" }}
                                            </div>
                                        </div>
                                        <h3 class="font-hand text-2xl text-gray-800 mb-2" x-text="event.localizedName"></h3>
                                        <a x-show="event.location" 
                                           :href="'https://www.google.com/maps/search/?api=1&query=' + encodeURIComponent(event.location + ', Ruinas Copan, Honduras')"
                                           target="_blank"
                                           rel="noopener noreferrer"
                                           class="inline-flex items-center text-gray-500 hover:text-rose text-sm font-sans italic mb-2 transition">
                                            <i class="fa-solid fa-location-dot mr-2 text-rose"></i>
                                            <span x-text="event.location"></span>
                                            <i class="fa-solid fa-external-link ml-1 text-xs"></i>
                                        </a>
                                        <p x-show="event.localizedDescription" class="text-gray-600 font-sans text-sm" x-text="event.localizedDescription"></p>
                                    </div>
                                </div>

                                <!-- Desktop: Timeline layout -->
                                <div class="hidden md:flex gap-6">
                                    <!-- Time Column -->
                                    <div class="w-32 flex-shrink-0 text-right">
                                        <p class="font-bold text-gray-800 font-sans" x-text="event.localStartTime"></p>
                                    </div>

                                    <!-- Timeline Dot -->
                                    <div class="flex flex-col items-center">
                                        <div class="w-4 h-4 rounded-full flex-shrink-0"
                                             :class="event.isPast ? 'bg-gray-300' : 'bg-lavender'"></div>
                                        <div class="w-0.5 flex-grow bg-gray-200 mt-2"
                                             x-show="index < dayEvents.length - 1"></div>
                                    </div>

                                    <!-- Event Details -->
                                    <div class="flex-grow pb-8">
                                        <div class="card-shadow bg-white p-6 rounded-2xl"
                                             :class="{ 'border-l-4 border-lavender': !event.isPast, 'border-l-4 border-gray-300': event.isPast }">
                                            <h3 class="font-hand text-3xl text-gray-800 mb-2" x-text="event.localizedName"></h3>
                                            <a x-show="event.location" 
                                               :href="'https://www.google.com/maps/search/?api=1&query=' + encodeURIComponent(event.location + ', Ruinas Copan, Honduras')"
                                               target="_blank"
                                               rel="noopener noreferrer"
                                               class="inline-flex items-center text-gray-500 hover:text-rose text-sm font-sans italic mb-2 transition">
                                                <i class="fa-solid fa-location-dot mr-2 text-rose"></i>
                                                <span x-text="event.location"></span>
                                                <i class="fa-solid fa-external-link ml-1 text-xs"></i>
                                            </a>
                                            <p x-show="event.localizedDescription" class="text-gray-600 font-sans text-sm" x-text="event.localizedDescription"></p>
                                            <!-- Past event indicator -->
                                            <div x-show="event.isPast" class="mt-3 inline-flex items-center text-xs font-semibold text-gray-400 font-sans">
                                                <i class="fa-solid fa-check mr-1"></i>
                                                {{ i18n "schedule_completed" }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </template>
        </div>
    </div>
</section>

<!-- Back to Home -->
<section class="py-8 px-6 bg-cream">
    <div class="max-w-4xl mx-auto text-center">
        <a href="{{ .Site.Home.RelPermalink }}" class="inline-flex items-center text-sm font-bold uppercase tracking-widest text-gray-600 hover:text-rose transition font-sans">
            <i class="fa-solid fa-arrow-left mr-2"></i>
            {{ i18n "schedule_back_home" }}
        </a>
    </div>
</section>
{{ end }}
