<!-- Details Section -->
<section id="details" class="section-colored py-16 md:py-24 px-6 bg-lavender relative overflow-hidden">
    <div class="max-w-6xl mx-auto relative z-10">
        <div class="text-center mb-12 md:mb-16">
            <span class="text-white/80 font-bold uppercase tracking-widest text-sm font-sans">{{ i18n "the_details" }}</span>
            <h2 class="font-hand text-5xl md:text-6xl mt-4 text-white">{{ i18n "join_us" }}</h2>
        </div>
        
        <div class="grid md:grid-cols-3 gap-6 md:gap-8">
            <!-- Date Card -->
            <div class="card-glass p-6 md:p-10 rounded-3xl text-center flex flex-col items-center group hover:border-ocean/30 transition-all duration-300">
                <div class="w-12 h-12 bg-ocean/30 text-ocean rounded-2xl flex items-center justify-center mb-6 group-hover:rotate-12 transition-transform">
                    <i class="fa-regular fa-calendar-check text-xl"></i>
                </div>
                <h3 class="font-hand text-3xl mb-4 text-gray-800">{{ i18n "when" }}</h3>
                <p class="font-bold text-gray-800 font-sans text-lg">{{ i18n "date_saturday" }}</p>
                <p class="text-gray-600 text-sm mt-1 font-sans">{{ i18n "date_wedding" }}</p>
                <div class="w-12 h-1 bg-ocean/40 my-4 rounded-full"></div>
                <a href="https://calendar.google.com/calendar/render?action=TEMPLATE&text=Laura+%26+Gerard%27s+Wedding&dates=20261219/20261220&location=Copan+Ruinas,+Honduras&details=Wedding+ceremony+and+celebration" 
                   target="_blank" 
                   class="text-xs font-bold uppercase tracking-widest text-ocean hover:text-clay hover:underline transition font-sans flex items-center">
                    {{ i18n "save_the_date_btn" }} <i class="fa-solid fa-arrow-up-right-from-square ml-2"></i>
                </a>
            </div>

            <!-- Ceremony Card -->
            <div class="card-glass p-6 md:p-10 rounded-3xl text-center flex flex-col items-center group hover:border-rose/30 transition-all duration-300">
                <div class="w-12 h-12 bg-rose/30 text-rose rounded-2xl flex items-center justify-center mb-6 group-hover:-rotate-12 transition-transform">
                    <i class="fa-solid fa-church text-xl"></i>
                </div>
                <h3 class="font-hand text-3xl mb-4 text-gray-800">{{ i18n "ceremony" }}</h3>
                <p class="font-bold text-gray-800 font-sans text-lg">{{ i18n "church_name" }}</p>
                <p class="text-gray-600 text-sm mt-1 font-sans">{{ i18n "church_location" }}</p>
                <div class="w-12 h-1 bg-rose/40 my-4 rounded-full"></div>
                <p class="text-rose font-bold text-sm uppercase tracking-wide font-sans bg-rose/20 px-4 py-1 rounded-full mb-4">{{ i18n "ceremony_time" }}</p>
                <a href="https://maps.app.goo.gl/3GoVE9yFq715tp7F9" 
                   target="_blank" 
                   class="text-xs font-bold uppercase tracking-widest text-rose hover:text-clay hover:underline transition font-sans flex items-center">
                    {{ i18n "view_map" }} <i class="fa-solid fa-arrow-up-right-from-square ml-2"></i>
                </a>
            </div>

            <!-- Celebration Card -->
            <div class="card-glass p-6 md:p-10 rounded-3xl text-center flex flex-col items-center group hover:border-marigold/30 transition-all duration-300">
                <div class="w-12 h-12 bg-marigold/30 text-marigold rounded-2xl flex items-center justify-center mb-6 group-hover:rotate-12 transition-transform">
                    <i class="fa-solid fa-champagne-glasses text-xl"></i>
                </div>
                <h3 class="font-hand text-3xl mb-4 text-gray-800">{{ i18n "celebration" }}</h3>
                <p class="font-bold text-gray-800 font-sans text-lg">{{ i18n "venue_name" }}</p>
                <p class="text-gray-600 text-sm mt-1 font-sans">{{ i18n "convention_center" }}</p>
                <div class="w-12 h-1 bg-marigold/40 my-4 rounded-full"></div>
                <p class="text-marigold font-bold text-sm uppercase tracking-wide font-sans bg-marigold/20 px-4 py-1 rounded-full mb-4">{{ i18n "celebration_time" }}</p>
                <a href="https://maps.app.goo.gl/HVyuTEbAo1hVCLpY9" 
                   target="_blank" 
                   class="text-xs font-bold uppercase tracking-widest text-marigold hover:text-clay hover:underline transition font-sans flex items-center">
                    {{ i18n "view_map" }} <i class="fa-solid fa-arrow-up-right-from-square ml-2"></i>
                </a>
            </div>
        </div>

        <!-- RSVP Banner -->
        <div x-data="rsvpForm"
             x-show="showSection"
             x-cloak
             id="rsvp"
             class="mt-8 md:mt-12 card-glass p-8 md:p-10 rounded-3xl border-2 border-leaf/20 group">
            <div class="flex flex-col md:flex-row items-start md:items-center space-y-4 md:space-y-0 md:space-x-8">
                <div class="w-16 h-16 bg-leaf/30 text-leaf rounded-2xl flex items-center justify-center group-hover:rotate-12 transition-transform">
                    <i class="fa-solid fa-envelope-open-text text-2xl"></i>
                </div>
                <div id="rsvp-card" 
                     class="flex-1" 
                     data-api-base="https://api.lauraygerard.wedding/api/v1" 
                     data-error-missing-plus-one="{{ i18n "rsvp_error_missing_plus_one" }}" 
                     data-error-missing-kids="{{ i18n "rsvp_error_missing_kids" }}" 
                     data-error-generic="{{ i18n "rsvp_error_generic" }}" 
                     data-invite-size-text="{{ i18n "rsvp_invite_size" }}">
                    <h3 class="font-hand text-3xl mb-2 text-gray-800">{{ i18n "rsvp_title" }}</h3>

                    <!-- Loading State -->
                    <div x-show="loading" class="mt-4 text-sm text-gray-500 font-sans">
                        <i class="fa-solid fa-spinner fa-spin mr-2"></i>{{ i18n "rsvp_loading" }}
                    </div>

                    <!-- Error State -->
                    <div x-show="error && !loading" 
                         x-cloak
                         class="mt-4 rounded-2xl border border-rose/30 bg-rose/10 p-4">
                        <p class="text-sm font-semibold text-rose">{{ i18n "rsvp_error_title" }}</p>
                        <p x-text="error" class="mt-1 text-sm text-gray-600 font-sans whitespace-pre-line"></p>
                    </div>

                    <!-- Thank You State -->
                    <div x-show="submitted && !loading" 
                         x-cloak
                         class="mt-6">
                        <p class="text-lg text-gray-700 font-sans">
                            {{ i18n "rsvp_thanks" }} <span x-text="invite?.name" class="font-semibold text-gray-800"></span>
                        </p>
                        <p class="text-sm text-gray-500 font-sans mt-2">{{ i18n "rsvp_thanks_note" }}</p>
                    </div>

                    <!-- RSVP Form -->
                    <div x-show="!loading && !submitted && invite" 
                         x-cloak
                         class="mt-6">
                        <div class="mb-6 space-y-2">
                            <p class="text-gray-700 font-sans">
                                {{ i18n "rsvp_greeting" }} <span x-text="invite?.name" class="font-semibold text-gray-800"></span>, {{ i18n "rsvp_hope" }}
                            </p>
                            <p class="text-gray-700 font-sans">
                                {{ i18n "rsvp_fill_info" }}
                            </p>
                            <p class="text-gray-700 font-sans">
                                <span x-text="inviteSizeMessage" class="font-semibold"></span>
                            </p>
                            <p class="text-gray-700 font-sans">
                                {{ i18n "rsvp_deadline" | markdownify }}
                            </p>
                        </div>
                        <form @submit.prevent="submitRSVP()" class="space-y-5">
                            <!-- +1 field (shown only when max_adults = 2) -->
                            <div x-show="showPlusOne" x-cloak>
                                <label class="flex items-center gap-3 cursor-pointer group">
                                    <input type="checkbox" 
                                           x-model="formData.plusOne"
                                           class="w-5 h-5 rounded border-gray-200 bg-white/80 accent-leaf focus:ring-leaf focus:ring-offset-0 focus:border-leaf hover:border-leaf/50 transition cursor-pointer">
                                    <span class="text-sm font-semibold text-gray-700 font-sans group-hover:text-leaf transition">{{ i18n "rsvp_plus_one_label" }}</span>
                                </label>
                            </div>

                            <!-- Kids field -->
                            <div x-show="showKids" x-cloak>
                                <label for="rsvp-kids" class="block text-sm font-semibold text-gray-700 font-sans">{{ i18n "rsvp_kids_label" }}</label>
                                <select x-model="formData.kidCount"
                                        id="rsvp-kids" 
                                        class="mt-2 w-full rounded-2xl border border-gray-200 bg-white/80 px-4 py-3 text-gray-700 font-sans focus:border-leaf focus:ring-2 focus:ring-leaf/30 focus:outline-none transition">
                                    <option value="" selected disabled>{{ i18n "rsvp_select_placeholder" }}</option>
                                    <template x-for="num in kidsOptions" :key="num">
                                        <option :value="num" x-text="num"></option>
                                    </template>
                                </select>
                                <p class="mt-2 text-xs text-gray-500 font-sans">{{ i18n "rsvp_kids_help" }} <span x-text="invite?.max_kids"></span></p>
                            </div>

                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label for="rsvp-dietary" class="block text-sm font-semibold text-gray-700 font-sans">{{ i18n "rsvp_dietary_label" }}</label>
                                    <input x-model="formData.dietaryInfo"
                                           id="rsvp-dietary" 
                                           type="text" 
                                           class="mt-2 w-full rounded-2xl border border-gray-200 bg-white/80 px-4 py-3 text-gray-700 font-sans focus:border-leaf focus:ring-2 focus:ring-leaf/30 focus:outline-none transition" 
                                           placeholder="{{ i18n "rsvp_dietary_placeholder" }}">
                                </div>
                                <div>
                                    <label for="rsvp-song" class="block text-sm font-semibold text-gray-700 font-sans">{{ i18n "rsvp_song_label" }}</label>
                                    <input x-model="formData.song"
                                           id="rsvp-song" 
                                           type="text" 
                                           class="mt-2 w-full rounded-2xl border border-gray-200 bg-white/80 px-4 py-3 text-gray-700 font-sans focus:border-leaf focus:ring-2 focus:ring-leaf/30 focus:outline-none transition" 
                                           placeholder="{{ i18n "rsvp_song_placeholder" }}">
                                </div>
                            </div>

                            <div>
                                <label for="rsvp-message" class="block text-sm font-semibold text-gray-700 font-sans">{{ i18n "rsvp_message_label" }}</label>
                                <textarea x-model="formData.message"
                                          id="rsvp-message" 
                                          rows="2" 
                                          class="mt-2 w-full rounded-2xl border border-gray-200 bg-white/80 px-4 py-3 text-gray-700 font-sans focus:border-leaf focus:ring-2 focus:ring-leaf/30 focus:outline-none transition" 
                                          placeholder="{{ i18n "rsvp_message_placeholder" }}"></textarea>
                            </div>

                            <button type="submit" 
                                    :disabled="submitting"
                                    :class="{ 'opacity-70': submitting }"
                                    class="w-full md:w-auto rounded-full bg-leaf px-6 py-3 text-sm font-semibold uppercase tracking-widest text-white shadow-sm transition hover:bg-leaf/90">
                                <span x-show="!submitting">{{ i18n "rsvp_submit" }}</span>
                                <span x-show="submitting" x-cloak>
                                    <i class="fa-solid fa-spinner fa-spin mr-2"></i>{{ i18n "rsvp_submitting" }}
                                </span>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
